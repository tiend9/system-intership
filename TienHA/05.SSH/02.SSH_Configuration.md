# THÃ”NG Sá» Cáº¤U HÃŒNH SSH

## I. CÃC FILE Cáº¤U HÃŒNH CHÃNH Cáº¦N LÆ¯U Ã

- `/etc/ssh/sshd_config` : File config cho phÃ©p mÃ¡y mÃ¬nh káº¿t ná»‘i ra ngoÃ i (Ä‘Ã³ng vai trÃ² nhÆ° 1 sever) â†’ sá»­a hoáº·c kiá»ƒm tra `sshd_config`, muá»‘n chá»‰nh sá»­a file thÃ¬ dÃ¹ng `sudo vi` or `sudo nano` vÃ  nhá»› `sudo systemctl restart sshd` Ä‘á»ƒ lÆ°u cáº¥u hÃ¬nh sau khi thay Ä‘á»•i

- `/etc/ssh/ssh_config` : File config cho phÃ©p mÃ¡y mÃ¬nh Ä‘Æ°á»£c SSH vÃ o (Ä‘Ã³ng vai trÃ² nhÆ° 1 client) â†’ chá»‰nh `ssh_config`, muá»‘n chá»‰nh sá»­a file thÃ¬ dÃ¹ng `sudo vi` or `sudo nano` vÃ  nhá»› `sudo systemctl restart ssh` Ä‘á»ƒ lÆ°u cáº¥u hÃ¬nh sau khi thay Ä‘á»•i

- `~/.ssh/config` : File cáº¥u hÃ¬nh SSH Client **trÃªn Linux**(ta check trÃªn Ubuntu hay CentOS vÃ  cÃ¹ng cÃ³ á»Ÿ Sever vÃ  Client)

- `/etc/nologin` : Náº¿u file nÃ y tá»“n táº¡i, thÃ¬ dá»‹ch vá»¥ SSH Server trÃªn Linux sáº½ tá»« chá»‘i Ä‘Äƒng nháº­p tá»« cÃ¡c user khÃ¡c trÃªn há»‡ thá»‘ng trá»« user `root`. File nÃ y thÆ°á»ng dÃ¹ng cho trÆ°á»ng há»£p kháº©n cáº¥p cáº§n cÃ¡ch ly há»‡ thá»‘ng sá»›m

**So sÃ¡nh `/etc/ssh/ssh_config` vÃ  `~/.ssh/config`:**

| Má»¥c so sÃ¡nh | `/etc/ssh/ssh_config` | `~/.ssh/config` | Ghi chÃº |
|--------------|-----------------------|-----------------|----------|
| **Pháº¡m vi Ã¡p dá»¥ng** | ToÃ n há»‡ thá»‘ng (system-wide) | RiÃªng cho user hiá»‡n táº¡i | User config sáº½ *ghi Ä‘Ã¨* lÃªn system config |
| **Vá»‹ trÃ­ file** | `/etc/ssh/ssh_config` | `/home/<username>/.ssh/config` | `~` = thÆ° má»¥c home cá»§a user |
| **Quyá»n chá»‰nh sá»­a** | Chá»‰ `root` cÃ³ quyá»n sá»­a | User nÃ o cÅ©ng cÃ³ thá»ƒ sá»­a file cá»§a mÃ¬nh | ThÆ°á»ng sysadmin chá»‰ Ä‘á»‹nh máº·c Ä‘á»‹nh á»Ÿ Ä‘Ã¢y |
| **ÄÆ°á»£c Ä‘á»c khi nÃ o** | SSH client khá»Ÿi Ä‘á»™ng | CÅ©ng váº­y, nhÆ°ng Ä‘á»c sau `/etc/ssh/ssh_config` | SSH Ä‘á»c theo thá»© tá»± â†’ system trÆ°á»›c, user sau |
| **á»¨ng dá»¥ng thá»±c táº¿** | Cáº¥u hÃ¬nh chung cho má»i user | DÃ nh cho tá»«ng user (tÃ¹y biáº¿n riÃªng) | ThÆ°á»ng Ä‘á»ƒ user Ä‘á»‹nh nghÄ©a host alias |

## II. CHá»ˆNH Sá»¬A FILE Cáº¤U HÃŒNH SSH

### 1. Má»Ÿ file cáº¥u hÃ¬nh Ä‘á»ƒ chá»‰nh sá»­a

#### Äá»‘i vá»›i SSH Sever(LÃ  con Ubuntu)

```ruby
sudo nano /etc/ssh/sshd_config
```

![SSH](./images/SSH_14.png)

- `Include /etc/ssh/sshd_config.d/*.conf`: Cho phÃ©p include thÃªm cÃ¡c file cáº¥u hÃ¬nh trong thÆ° má»¥c `/etc/ssh/sshd_config.d/`. ÄÃ¢y lÃ  cÃ¡ch má»›i (trÃªn Ubuntu 20.04+, Debian 10+, CentOS Stream 9â€¦) Ä‘á»ƒ tÃ¡ch cáº¥u hÃ¬nh ra file nhá».

- `Cá»•ng 22`: lÃ  cá»•ng máº·c Ä‘á»‹nh Ä‘á»ƒ Forwarding tá»‡p tin giá»¯a Client vÃ  Sever

- `ListenAddress 0.0.0.0`: Khi Ä‘á»ƒ cháº¿ Ä‘á»™ nÃ y SSH Sever sáº½ láº¯ng nghe trÃªn táº¥t cáº£ IPv4

- `ListenAddress ::`: Khi Ä‘á»ƒ cháº¿ Ä‘á»™ nÃ y SSH Sever sáº½ láº¯ng nghe trÃªn táº¥t cáº£ IPv6

- `HostKey /etc/ssh/ssh_host_rsa_key`: Chá»‰ Ä‘á»‹nh key host mÃ  SSH dÃ¹ng. Máº·c Ä‘á»‹nh sáº½ cÃ³ RSA, ECDSA, ED25519.

- `#RekeyLimit default none`: Giá»›i háº¡n dung lÆ°á»£ng dá»¯ liá»‡u truyá»n trÆ°á»›c khi báº¯t buá»™c rekey. Náº¿u none thÃ¬ dÃ¹ng máº·c Ä‘á»‹nh.

#### Äá»‘i vá»›i SSH Client(LÃ  con MobaXterm)

```ruby
sudo nano /etc/ssh/ssh_config
```

![SSH](./images/SSH_15.png)

### 2. Äá»•i Port

- Dá»‹ch vá»¥ SSH máº·c Ä‘á»‹nh hoáº¡t Ä‘á»™ng trÃªn port `22` . VÃ¬ lÃ  port phá»• biáº¿n , ráº¥t dá»… bá»‹ káº» xáº¥u thá»±c hiá»‡n cÃ¡c hoáº¡t Ä‘á»™ng dÃ² tÃ¬m máº­t kháº©u tá»± Ä‘á»™ng Ä‘Äƒng nháº­p SSH vÃ o há»‡ thá»‘ng .

- Äá»ƒ Ä‘iá»u chá»‰nh port máº·c Ä‘á»‹nh , xuá»‘ng dÃ²ng `17 Port`, chá»‰ Ä‘á»‹nh port má»›i , Ä‘á»“ng thá»i bá» dáº¥u `#` á»Ÿ Ä‘áº§u dÃ²ng. VÃ­ dá»¥, ta Ä‘á»•i sang `port 6666` vÃ  Client chá»‰ cáº§n quan tÃ¢m dáº¿n Ä‘Ãºng Port cá»§a Sever má»Ÿ Ä‘á»ƒ káº¿t ná»‘i

=> **VÃ¬ váº­y, ta chá»‰ cáº§n Ä‘á»•i Port trong file cáº¥u hÃ¬nh cá»§a con Sever lÃ  Ä‘Æ°á»£c nhÆ°ng lÆ°u Ã½ Port khÃ´ng Ä‘Æ°á»£c trÃ¹ng vá»›i Port cÃ³ dá»‹ch vá»¥ Ä‘áº·c biá»‡t**

![SSH](./images/SSH_16.png)

### 3. Giá»›i háº¡n IP láº¯ng nghe SSH

- Náº¿u há»‡ thá»‘ng cÃ³ nhiá»u hÆ¡n 1 Ä‘á»‹a chá»‰ IP thÃ¬ tá»‘t nháº¥t nÃªn chá»‰ Ä‘á»‹nh rÃµ Ä‘á»‹a chá»‰ IP nÃ o sáº½ láº¯ng nghe port SSH . Thá»±c
  hiá»‡n sá»­a Ä‘á»•i á»Ÿ dÃ²ng `19 ListenAddress` , Ä‘á»“ng thá»i bá» dáº¥u `#` á»Ÿ Ä‘áº§u dÃ²ng ( `0.0.0.0` cÃ³ nghÄ©a lÃ  má»i IP Ä‘á»u láº¯ng
  nghe SSH ):

![SSH](./images/SSH_17.png)

### 4. Timeout khi user Ä‘Äƒng nháº­p khÃ´ng thÃ nh cÃ´ng

- Khi 1 user Ä‘Äƒng nháº­p SSH , náº¿u khÃ´ng chá»‰ Ä‘á»‹nh thÃ´ng tin user tá»« Ä‘áº§u thÃ¬ sáº½ hiá»‡n ra 1 prompt yÃªu cáº§u nháº­p thÃ´ng tin User . Sau Ä‘Ã³ lÃ  pháº§n nháº­p máº­t kháº©u náº¿u user Ä‘Ã³ Ä‘Äƒng nháº­p báº±ng máº­t kháº©u . Ta sáº½ quy Ä‘á»‹nh thá»i gian 1 káº¿t ná»‘i SSH Ä‘á»£i cho hoáº¡t Ä‘á»™ng Ä‘Äƒng nháº­p user thÃ nh cÃ´ng , náº¿u sau khoáº£ng thá»i gian nÃ y khÃ´ng Ä‘Äƒng nháº­p Ä‘Æ°á»£c thÃ¬ ngáº¯t káº¿t ná»‘i.

- Thay Ä‘á»•i tÃ¹y chá»n nÃ y á»Ÿ dÃ²ng `37 LoginGraceTime`( máº·c Ä‘á»‹nh Ä‘Ã£ Ä‘Æ°á»£c cáº¥u hÃ¬nh lÃ  2 phÃºt )

![SSH](./images/SSH_18.png)

### 5. KhÃ´ng cho User `root` Ä‘Äƒng nháº­p

- Äá»ƒ tÄƒng tÃ­nh báº£o máº­t cho há»‡ thá»‘ng, báº¡n khÃ´ng nÃªn cho Ä‘Äƒng nháº­p báº±ng user `root`.

- Khi muá»‘n sá»­ dá»¥ng quyá»n `root` thÃ¬ chá»‰ cáº§n táº¡o user rá»“i cáº¥p quyá»n sudo cho user Ä‘Ã³.

- Äá»ƒ ngÄƒn khÃ´ng cho ssh báº±ng tÃ i khoáº£n `root`. TÃ¬m Ä‘áº¿n dÃ²ng `38 PermitRootLogin`, sá»­a `yes` thÃ nh `no` Ä‘á»“ng thá»i bá» dáº¥u `#` á»Ÿ Ä‘áº§u dÃ²ng :

![SSH](./images/SSH_19.png)

### 6. Cháº¿ Ä‘á»™ "Strict Mode"

- Ta sáº½ chá»‰ Ä‘á»‹nh dá»‹ch vá»¥ SSH pháº£i kiá»ƒm tra thÃ´ng tin quyá»n cá»§a thÆ° má»¥c `$HomeUser` , thÆ° má»¥c `.ssh` vÃ  file `authorized_keys` chá»©a key SSH náº¿u dÃ¹ng SSH key.

- Náº¿u khÃ´ng sá»­ dá»¥ng cháº¿ Ä‘á»™ nÃ y ( `no` ) thÃ¬ SSH sáº½ khÃ´ng kiá»ƒm tra cáº¥u hÃ¬nh cÃ¡c quyá»n khi Ä‘Äƒng nháº­p vÃ o Server -> Ã‰p ngÆ°á»i quáº£n trá»‹ pháº£i cáº¥u hÃ¬nh Ä‘Ãºng cÃ¡c phÃ¢n quyá»n ( permissions ) cho cÃ¡c thÆ° má»¥c `/ key` dÃ¹ng Ä‘á»ƒ Ä‘Äƒng nháº­p SSH

- Thay Ä‘á»•i tÃ¹y chá»n nÃ y á»Ÿ dÃ²ng `39 StrictModes` (máº·c Ä‘á»‹nh Ä‘á»ƒ `yes`)

![SSH](./images/SSH_20.png)

### 7. Thiáº¿t láº­p sá»‘ láº§n Ä‘Äƒng nháº­p sai tá»‘i Ä‘a

- Náº¿u Ä‘Äƒng nháº­p sai sá»‘ láº§n quy Ä‘á»‹nh sáº½ ngáº¯t káº¿t ná»‘i cá»§a Client .

- Thay Ä‘á»•i tÃ¹y chá»n nÃ y á»Ÿ dÃ²ng `40 MaxAuthTries`( máº·c Ä‘á»‹nh lÃ  6 ) :

![SSH](./images/SSH_21.png)

### 8. Sá»‘ phiÃªn Ä‘Äƒng nháº­p SSH tá»‘i Ä‘a

- Thay Ä‘á»•i giÃ¡ trá»‹ táº¡i dÃ²ng `41 MaxSessions` (máº·c Ä‘á»‹nh lÃ  10)

![SSH](./images/SSH_22.png)

### 9. Sá»­ dá»¥ng chá»©ng thá»±c báº±ng SSH key , thay vÃ¬ máº­t kháº©u

- Máº·c Ä‘á»‹nh , má»—i VPS/Cloud Server sáº½ Ä‘Äƒng nháº­p vÃ o báº±ng user root hoáº·c user thÆ°á»ng . Tuy nhiÃªn viá»‡c sá»­ dá»¥ng máº­t kháº©u cÃ³ 2 nguy cÆ¡ lá»›n lÃ  :

  - Máº¥t toÃ n bá»™ há»‡ thá»‘ng náº¿u Ä‘á»ƒ lá»™ máº­t kháº©u
  - Hacker cÃ³ thá»ƒ dÃ¹ng phÆ°Æ¡ng thá»©c táº¥n cÃ´ng**BruteForce** Ä‘á»ƒ dÃ² ra máº­t kháº©u

- VÃ¬ váº­y nÃªn dÃ¹ng SSH Key Ä‘á»ƒ Ä‘Äƒng nháº­p vÃ o Server cÅ©ng nhÆ° sá»­ dá»¥ng nÃ³ Ä‘á»ƒ xÃ¡c thá»±c cÃ¡c káº¿t ná»‘i tá»« bÃªn ngoÃ i vÃ o cho an toÃ n hÆ¡n . Äá»“ng thá»i , náº¿u cÃ³ thá»ƒ nÃªn táº¯t cáº¥u hÃ¬nh chá»©ng thá»±c máº­t kháº©u.

- Thá»±c hiá»‡n thay Ä‘á»•i á»Ÿ dÃ²ng `43 PubkeyAuthentication` vÃ  `65 PasswordAuthentication`

![SSH](./images/SSH_22.png)

![SSH](./images/SSH_23.png)

### 10. Táº¯t log Last login

- Äá»ƒ táº¯t log Ä‘Äƒng nháº­p láº§n cuá»‘i, ta chá»‰nh sá»­a dÃ²ng `106 PrintLastLog` (máº·c Ä‘á»‹nh lÃ  `yes`) Ä‘á»•i thÃ nh `no`

![SSH](./images/SSH_24.png)

### 11. Cáº¥u hÃ¬nh thá»i gian ngáº¯t káº¿t ná»‘i SSH khi User khÃ´ng hoáº¡t Ä‘á»™ng

- CÃ³ thá»ƒ quy Ä‘á»‹nh thá»i gian timeout mÃ  1 káº¿t ná»‘i SSH Ä‘áº¿n Server Linux khÃ´ng nháº­n Ä‘Æ°á»£c báº¥t ká»³ hoáº¡t Ä‘á»™ng tÆ°Æ¡ng tÃ¡c nÃ o trÃªn Terminal SSH . LÃºc nÃ y náº¿u quÃ¡ thá»i gian quy Ä‘á»‹nh thÃ¬ SSH Server sáº½ tá»± ngáº¯t káº¿t ná»‘i tá»« cÃ¡c user khÃ´ng tÆ°Æ¡ng tÃ¡c.

- Thá»±c hiá»‡n thay Ä‘á»•i á»Ÿ dÃ²ng `112 ClientAliveInterval` vÃ  `113 ClientAliveCountMax`, Ä‘á»“ng thá»i bá» dáº¥u `#` á»Ÿ Ä‘áº§u dÃ²ng :

![SSH](./images/SSH_25.png)

### 12. Giá»›i háº¡n User/Group sá»­ dá»¥ng cho SSH

- Máº·c Ä‘á»‹nh SSH Server cho phÃ©p táº¥t cáº£ cÃ¡c user local Ä‘Äƒng nháº­p qua SSH . NhÆ°ng Ä‘Ã´i khi cáº§n cháº·n khÃ´ng cho Ä‘Äƒng nháº­p vá»›i 1 sá»‘ user nháº¥t Ä‘á»‹nh hoáº·c 1 nhÃ³m cá»¥ thá»ƒ

- Äá»ƒ **cho phÃ©p** user hoáº·c group Ä‘Æ°á»£c Ä‘Äƒng nháº­p SSH , thá»±c hiá»‡n thÃªm vÃ o 1 sá»‘ dÃ²ng sau vÃ o cuá»‘i file:

  ```ruby
  AllowUsers user_name1 user_name2
  AllowGroups group_name1 group_name2
  ```

- Äá»ƒ **khÃ´ng cho phÃ©p** user hoáº·c group Ä‘Æ°á»£c Ä‘Äƒng nháº­p SSH , thá»±c hiá»‡n thÃªm vÃ o 1 sá»‘ dÃ²ng sau vÃ o cuá»‘i file

  ```ruby
  DenyUsers user_name1 user_name2
  DenyGroups group_name1 group_name2
  ```

### 13. ÄÆ°á»ng dáº«n tá»›i file key

- Náº¿u báº¡n táº¡o file key á»Ÿ 1 vá»‹ trÃ­ khÃ¡c máº·c Ä‘á»‹nh, ta cÃ³ thá»ƒ thay Ä‘á»•i Ä‘Æ°á»ng dáº«n táº¡i dÃ²ng `47 AuthorizedKeysFile`

![SSH](./images/SSH_26.png)

### 14. Kiá»ƒm tra file cáº¥u hÃ¬nh

Thá»±c hiá»‡n kiá»ƒm tra láº¡i quÃ¡ trÃ¬nh sá»­a Ä‘á»•i file `sshd_config` xem cÃ³ sai khÃ´ng , náº¿u sai sáº½ bÃ¡o lá»—i :

```ruby
sudo sshd -t
```

### 15. Cho phÃ©p SSH qua Firewall khÃ´ng cháº·n Port

#### a, TrÃªn CentOS

```ruby
sudo firewall-cmd --permanent --zone=public --add-port=2222/tcp
sudo firewall-cmd --reload
```

hoáº·c

```ruby
sudo firewall-cmd --permanent --zone=public --add-service=ssh
sudo firewall-cmd --reload
```

#### b, TrÃªn Ubuntu

```ruby
sudo ufw allow 2222/tcp
```

### 16. Khá»Ÿi Ä‘á»™ng láº¡i dá»‹ch vá»¥ SSH vÃ  kiá»ƒm tra tráº¡ng thÃ¡i

```ruby
sudo systemctl start sshd (Khá»Ÿi Ä‘á»™ng dá»‹ch vá»¥ SSH)
sudo systemctl restart sshd (khá»Ÿi Ä‘á»™ng láº¡i dá»‹ch vá»¥ SSH )
sudo systemctl enable sshd (Tá»± Ä‘á»™ng cháº¡y má»—i khi khá»Ÿi Ä‘á»™ng mÃ¡y áº£o)
```

Or

```ruby
sudo systemctl status sshd
```

![SSH](./images/SSH_27.png)

### 17. Ngáº¯t Firewall táº¡m thá»i hoáº·c ngáº¯t háº³n Ä‘á»ƒ SSH qua Firewall khÃ´ng cháº·n Port

#### a, TrÃªn CentOS 9

Táº¡m thá»i (Ä‘áº¿n khi reboot láº¡i):

```ruby
sudo systemctl stop firewalld
```

VÃ  náº¿u mÃ y muá»‘n táº¯t háº³n luÃ´n, Ä‘á»ƒ láº§n sau khá»Ÿi Ä‘á»™ng khÃ´ng báº­t ná»¯a:

```ruby
sudo systemctl disable firewalld
```

Check tráº¡ng thÃ¡i Firewall:

```ruby
sudo systemctl status firewalld
```

#### b,TrÃªn Ubuntu

Check tráº¡ng thÃ¡i hiá»‡n táº¡i cá»§a Firewall :

```ruby
sudo ufw status
```

Náº¿u tráº¡ng thÃ¡i lÃ  ->`Active` thÃ¬ ta ngáº¯t nÃ³ :

```ruby
sudo ufw disable
```

Sau báº­t láº¡i thÃ¬ ta thay `disable` -> `enable`

### 18. Cáº¥u hÃ¬nh SSH Client (`~/.ssh/config`)

File nÃ y giÃºp cáº¥u hÃ¬nh SSH Client trÃªn mÃ¡y khÃ¡ch Ä‘á»ƒ káº¿t ná»‘i nhanh hÆ¡n.

#### Host

- **Chá»©c nÄƒng:** Äá»‹nh nghÄ©a má»™t khá»‘i cáº¥u hÃ¬nh riÃªng biá»‡t cho má»™t hoáº·c nhiá»u mÃ¡y chá»§. Äiá»u nÃ y cho phÃ©p báº¡n thiáº¿t láº­p cÃ¡c tÃ¹y chá»n khÃ¡c nhau cho tá»«ng mÃ¡y chá»§ thÆ°á»ng xuyÃªn káº¿t ná»‘i Ä‘áº¿n.

- VÃ­ dá»¥: Náº¿u thÆ°á»ng xuyÃªn SSH vÃ o 192.168.1.100 vá»›i user ubuntu vÃ  cá»•ng 2222, thay vÃ¬ gÃµ lá»‡nh dÃ i:

  ```ruby
  ssh -p 2222 ubuntu@192.168.1.100
  ```

- CÃ³ thá»ƒ cáº¥u hÃ¬nh nhÆ° sau:

  ```ruby
  Host myserver
    HostName 192.168.1.100
    User ubuntu
    Port 2222
    IdentityFile ~/.ssh/id_rsa
  ```

  - `IdentityFil`: XÃ¡c Ä‘á»‹nh Ä‘Æ°á»ng dáº«n Ä‘áº¿n tá»‡p chá»©a khÃ³a riÃªng tÆ° (private key) mÃ  SSH client sáº½ sá»­ dá»¥ng Ä‘á»ƒ xÃ¡c thá»±c báº±ng khÃ³a cÃ´ng khai.
- Sau Ä‘Ã³ chá»‰ cáº§n gÃµ lá»‡nh:

  ```ruby
  ssh myserver
  ```

### 18. Cáº¥u hÃ¬nh SeLinux (TrÃ¡nh cho cháº·n káº¿t ná»‘i SSH)

SELinux lÃ  viáº¿t táº¯t cá»§a Security-Enhanced Linux â€” hiá»ƒu nÃ´m na lÃ  há»‡ thá»‘ng an ninh cáº¥p tháº¥p cá»§a Linux, kiá»ƒu nhÆ° â€œvá»‡ sÄ© riÃªngâ€ canh tá»«ng hÃ nh Ä‘á»™ng cá»§a tiáº¿n trÃ¬nh (process). VÃ  nÃ³ lÃ  nguyÃªn nhÃ¢n cháº·n cÃ¡c tiáº¿n trÃ¬nh cá»§a SSH.

TrÃªn Linux, quyá»n báº£o máº­t chá»§ yáº¿u dá»±a vÃ o:

- User/Group/Other

- File permission (rwx)

â†’ Náº¿u mÃ y lÃ  root thÃ¬ mÃ y gáº§n nhÆ° lÃ m gÃ¬ cÅ©ng Ä‘Æ°á»£c.

NhÆ°ng vá»›i SELinux: NÃ³ thÃªm má»™t lá»›p báº£o máº­t máº¡nh hÆ¡n, gá»i lÃ  MAC (Mandatory Access Control).

-> DÃ¹ mÃ y lÃ  root, váº«n bá»‹ giá»›i háº¡n hÃ nh Ä‘á»™ng náº¿u SELinux policy khÃ´ng cho phÃ©p.

TÃ³m táº¯t láº¡i:

| ğŸ§© Má»¥c Ä‘Ã­ch | ğŸ’» Lá»‡nh |
|--------------|---------|
| **Kiá»ƒm tra SELinux** | `sestatus` |
| **Táº¯t táº¡m thá»i** | `sudo setenforce 0` |
| **Táº¯t vÄ©nh viá»…n** | Sá»­a file `/etc/selinux/config` â†’ `SELINUX=disabled` |
| **Giá»¯ báº­t nhÆ°ng má»Ÿ port má»›i** | `sudo semanage port -a -t ssh_port_t -p tcp 2222` |

### 19. Huá»· dá»‹ch vá»¥ SSH

| Má»¥c Ä‘Ã­ch                     | Lá»‡nh tÆ°Æ¡ng á»©ng                      | Giáº£i thÃ­ch                                            |
| ---------------------------- | ----------------------------------- | ----------------------------------------------------- |
| ğŸ’¤ **Dá»«ng táº¡m thá»i**         | `sudo systemctl stop ssh`           | SSH dá»«ng ngay, nhÆ°ng **khá»Ÿi Ä‘á»™ng láº¡i mÃ¡y sáº½ báº­t láº¡i** |
| ğŸš« **VÃ´ hiá»‡u hÃ³a vÄ©nh viá»…n** | `sudo systemctl disable ssh`        | SSH **khÃ´ng tá»± khá»Ÿi Ä‘á»™ng cÃ¹ng há»‡ thá»‘ng**              |
| ğŸ”„ **XÃ³a hoÃ n toÃ n**         | `sudo apt remove openssh-server -y` or `sudo dnf remove openssh-sever -y` | Gá»¡ háº³n SSH server khá»i há»‡ thá»‘ng                       |

âš ï¸ **LÆ°u Ã½ quan trá»ng:**

Náº¿u báº¡n Ä‘ang SSH vÃ o mÃ¡y tá»« xa, mÃ  dá»«ng dá»‹ch vá»¥ SSH â†’ máº¥t káº¿t ná»‘i ngay láº­p tá»©c (vÃ  khÃ´ng thá»ƒ SSH láº¡i ná»¯a).
ğŸ‘‰ NÃªn lÃ m trá»±c tiáº¿p trÃªn console, hoáº·c mÃ¡y áº£o qua mÃ n hÃ¬nh áº£o (VMware, VirtualBox, vSphere...).

Sau khi gá»¡, náº¿u muá»‘n báº­t láº¡i:

**Ubuntu:**

```ruby
sudo apt install openssh-server -y
sudo systemctl enable --now ssh
```

**CentOS:**

```ruby
sudo dnf install openssh-server -y
sudo systemctl enable --now sshd
```
